proxy-anchor:
  select_use: &select_use
    type: select
    include-all: true
    exclude-type: "dns"
  
  auto_use: &auto_use
    type: url-test
    include-all: true
    exclude-type: "dns"

  select_proxy: &select_proxy
    type: select
    proxies: [ä¸»è¦èŠ‚ç‚¹, æ‰‹åŠ¨åˆ‡æ¢, è‡ªåŠ¨é€‰æ‹©, æ•…éšœè½¬ç§»ç»„, æ‰‹åŠ¨é€‰æ‹©_é¦™æ¸¯, æ‰‹åŠ¨é€‰æ‹©_å°æ¹¾, æ‰‹åŠ¨é€‰æ‹©_æ–°åŠ å¡, æ‰‹åŠ¨é€‰æ‹©_æ—¥æœ¬, æ‰‹åŠ¨é€‰æ‹©_ç¾å›½, å›½å†…ç›´è¿, å¹¿å‘Šæ‹¦æˆª]

  test_proxy: &test_proxy
    type: file
    health-check:
      enable: true
      url: https://cp.cloudflare.com
      interval: 300
      timeout: 1000
      tolerance: 100

proxy-providers:
  proxy1:
    <<: *test_proxy
    path: ./proxy_provider/proxy1.yaml

mixed-port: 7890
redir-port: 9797
tproxy-port: 9898
mode: Rule
bind-address: '*'
ipv6: true
allow-lan: true
unified-delay: true
tcp-concurrent: true
log-level: error
find-process-mode: always
global-client-fingerprint: random
external-controller: 0.0.0.0:9090
secret: ""
external-ui: ./dashboard

profile:
  store-selected: true
  store-fake-ip: true

sniffer:
  enable: true
  force-dns-mapping: true
  parse-pure-ip: true
  sniff:
    HTTP:
      ports: [80, 8080-8880]
    TLS:
      ports: [443, 8443]
    QUIC:
      ports: [443, 8443]

tun:
  enable: false
  device: meta
  stack: mixed
  dns-hijack: [any:53, tcp://any:53]
  udp-timeout: 300
  auto-route: true
  auto-redirect: false
  auto-detect-interface: true
  strict-route: false

dns:
  enable: true
  prefer-h3: true
  ipv6: true
  listen: 0.0.0.0:1053
  enhanced-mode: fake-ip
  fake-ip-range: 28.0.0.1/8
  fake-ip-filter:
    - "rule-set:Fake-IP-Filter"
  proxy-server-nameserver:
    - https://dns.alidns.com/dns-query
    - https://doh.pub/dns-query
  nameserver-policy:
    "rule-set:cn_domain":
      - https://dns.alidns.com/dns-query
      - https://doh.pub/dns-query
    "rule-set:awavenue":
      - rcode://success
  nameserver:
    - https://cloudflare-dns.com/dns-query#DNS
    - https://dns.google/dns-query#DNS

proxies:
  - {name: DNS_Hijack, type: dns}

proxy-groups:
  - name: Ai
    <<: *select_proxy
    icon: https://gitlab.com/akikawa/backup/-/raw/main/IconSet/Color/AI.png

  - name: FCMæ¨é€
    <<: *select_proxy
    icon: https://gitlab.com/akikawa/backup/-/raw/main/IconSet/Color/Mail.png

  - name: è°·æ­ŒæœåŠ¡
    <<: *select_proxy
    icon: https://gitlab.com/akikawa/backup/-/raw/main/IconSet/Color/Google_Search.png

  - name: å¾®è½¯æœåŠ¡
    <<: *select_proxy
    icon: https://gitlab.com/akikawa/backup/-/raw/main/IconSet/Color/Microsoft.png

  - name: GITHUB
    <<: *select_proxy
    icon: https://gitlab.com/akikawa/backup/-/raw/main/IconSet/Color/GitHub.png

  - name: æ²¹ç®¡è§†é¢‘
    <<: *select_proxy
    icon: https://gitlab.com/akikawa/backup/-/raw/main/IconSet/Color/YouTube.png

  - name: å¥ˆé£è§†é¢‘
    <<: *select_proxy
    icon: https://gitlab.com/akikawa/backup/-/raw/main/IconSet/Color/Netflix.png

  - name: ç”µæŠ¥æ¶ˆæ¯
    <<: *select_proxy
    icon: https://gitlab.com/akikawa/backup/-/raw/main/IconSet/Color/Telegram.png

  - name: å›½å¤–ä»£ç†
    <<: *select_proxy
    icon: https://gitlab.com/akikawa/backup/-/raw/main/IconSet/Color/Proxy.png

  - name: å›½å†…ç›´è¿
    type: select
    proxies: [DIRECT, REJECT]
    include-all: true
    exclude-type: "dns"
    icon: https://gitlab.com/akikawa/backup/-/raw/main/IconSet/Color/China.png

  - name: DNS
    <<: *select_proxy
    icon: https://gitlab.com/akikawa/backup/-/raw/main/IconSet/Color/Domestic.png

  - name: å¹¿å‘Šæ‹¦æˆª
    type: select
    proxies: [REJECT, å›½å†…ç›´è¿, REJECT-DROP, PASS]
    icon: https://gitlab.com/akikawa/backup/-/raw/main/IconSet/Color/Reject.png

  - name: æ¼ç½‘ä¹‹é±¼
    <<: *select_proxy
    icon: https://gitlab.com/akikawa/backup/-/raw/main/IconSet/Color/Final.png

  - name: ä¸»è¦èŠ‚ç‚¹
    type: select
    proxies: [æ‰‹åŠ¨åˆ‡æ¢, è‡ªåŠ¨é€‰æ‹©, æ•…éšœè½¬ç§»ç»„, æ‰‹åŠ¨é€‰æ‹©_é¦™æ¸¯, æ‰‹åŠ¨é€‰æ‹©_å°æ¹¾, æ‰‹åŠ¨é€‰æ‹©_æ–°åŠ å¡, æ‰‹åŠ¨é€‰æ‹©_æ—¥æœ¬, æ‰‹åŠ¨é€‰æ‹©_ç¾å›½, å›½å†…ç›´è¿, å¹¿å‘Šæ‹¦æˆª]
    icon: https://gitlab.com/akikawa/backup/-/raw/main/IconSet/Color/Star.png

  - name: æ‰‹åŠ¨åˆ‡æ¢
    <<: *select_use
    icon: https://gitlab.com/akikawa/backup/-/raw/main/IconSet/Color/Rocket.png

  - name: æ•…éšœè½¬ç§»ç»„
    type: fallback
    proxies: [æ‰‹åŠ¨é€‰æ‹©_é¦™æ¸¯, æ‰‹åŠ¨é€‰æ‹©_å°æ¹¾, æ‰‹åŠ¨é€‰æ‹©_æ–°åŠ å¡, æ‰‹åŠ¨é€‰æ‹©_æ—¥æœ¬, æ‰‹åŠ¨é€‰æ‹©_ç¾å›½]
    icon: https://gitlab.com/akikawa/backup/-/raw/main/IconSet/Color/Back.png

  - name: æ‰‹åŠ¨é€‰æ‹©_é¦™æ¸¯
    <<: *select_use
    filter: "(?i)(ğŸ‡­ğŸ‡°|é¦™æ¸¯|hong kong|hk|hksar)"
    icon: https://gitlab.com/akikawa/backup/-/raw/main/IconSet/Color/Hong_Kong.png

  - name: æ‰‹åŠ¨é€‰æ‹©_å°æ¹¾
    <<: *select_use
    filter: "(?i)(ğŸ‡¹ğŸ‡¼|å°æ¹¾|taiwan|tw|twn|å°åŒ—|taipei|é«˜é›„|kaohsiung|å°ä¸­|taichung|æ–°åŒ—|new taipei)"
    icon: https://gitlab.com/akikawa/backup/-/raw/main/IconSet/Color/Taiwan.png

  - name: æ‰‹åŠ¨é€‰æ‹©_æ–°åŠ å¡
    <<: *select_use
    filter: "(?i)(ğŸ‡¸ğŸ‡¬|æ–°åŠ å¡|ç‹®åŸ|singapore|sg|sgp)"
    icon: https://gitlab.com/akikawa/backup/-/raw/main/IconSet/Color/Singapore.png

  - name: æ‰‹åŠ¨é€‰æ‹©_æ—¥æœ¬
    <<: *select_use
    filter: "(?i)(ğŸ‡¹ğŸ‡¼|æ—¥æœ¬|japan|jpn|jp|tokyo|å¤§é˜ª|osaka|äº¬éƒ½|kyoto|ç¦å†ˆ|fukuoka|æœ­å¹Œ|sapporo|åå¤å±‹|nagoya)"
    icon: https://gitlab.com/akikawa/backup/-/raw/main/IconSet/Color/Japan.png

  - name: æ‰‹åŠ¨é€‰æ‹©_ç¾å›½
    <<: *select_use
    filter: "(?i)(ğŸ‡ºğŸ‡¸|ç¾å›½|united states|usa|us|america|åŠ å·|california|çº½çº¦|new york|å¾·å…‹è¨æ–¯|texas|ä½›ç½—é‡Œè¾¾|florida|åç››é¡¿|washington|èŠåŠ å“¥|chicago|æ´›æ‰çŸ¶|los angeles|æ—§é‡‘å±±|san francisco)"
    icon: https://gitlab.com/akikawa/backup/-/raw/main/IconSet/Color/United_States.png

  - name: è‡ªåŠ¨é€‰æ‹©
    <<: *auto_use
    icon: https://gitlab.com/akikawa/backup/-/raw/main/IconSet/Color/Auto.png

rule-anchor:
  classical: &classical
    type: http
    behavior: classical
    format: yaml
    interval: 86400

  ipcidr: &ipcidr
    type: http
    behavior: ipcidr
    format: mrs
    interval: 86400

  domain: &domain
    type: http
    behavior: domain
    format: mrs
    interval: 86400

rule-providers:
  Ai:
    <<: *domain
    path: ./rule_provider/ai.mrs
    url: "https://raw.githubusercontent.com/DustinWin/ruleset_geodata/refs/heads/mihomo-ruleset/ai.mrs"
  Fake-IP-Filter:
    <<: *domain
    path: ./rule_provider/Fake-IP-Filter.mrs
    url: "https://github.com/DustinWin/ruleset_geodata/raw/refs/heads/mihomo-ruleset/fakeip-filter.mrs"
  netflix_ip:
    <<: *ipcidr
    path: ./rule_provider/netflix_ip.mrs
    url: "https://github.com/MetaCubeX/meta-rules-dat/raw/refs/heads/meta/geo/geoip/netflix.mrs"
  netflix_domain:
    <<: *domain
    path: ./rule_provider/netflix_domain.mrs
    url: "https://github.com/MetaCubeX/meta-rules-dat/raw/refs/heads/meta/geo/geosite/netflix.mrs"
  telegram_ip:
    <<: *ipcidr
    path: ./rule_provider/telegram_ip.mrs
    url: "https://github.com/MetaCubeX/meta-rules-dat/raw/refs/heads/meta/geo/geoip/telegram.mrs"
  telegram_domain:
    <<: *domain
    path: ./rule_provider/telegram_domain.mrs
    url: "https://github.com/MetaCubeX/meta-rules-dat/raw/refs/heads/meta/geo/geosite/telegram.mrs"
  github_domain:
    <<: *domain
    path: ./rule_provider/github_domain.mrs
    url: "https://github.com/MetaCubeX/meta-rules-dat/raw/refs/heads/meta/geo/geosite/github.mrs"
  youtube_domain:
    <<: *domain
    path: ./rule_provider/youtube_domain.mrs
    url: "https://github.com/MetaCubeX/meta-rules-dat/raw/refs/heads/meta/geo/geosite/youtube.mrs"
  google_ip:
    <<: *ipcidr
    path: ./rule_provider/google_ip.mrs
    url: "https://github.com/MetaCubeX/meta-rules-dat/raw/refs/heads/meta/geo/geoip/google.mrs"
  google_domain:
    <<: *domain
    path: ./rule_provider/google_domain.mrs
    url: "https://github.com/MetaCubeX/meta-rules-dat/raw/refs/heads/meta/geo/geosite/google.mrs"
  microsoft_domain:
    <<: *domain
    path: ./rule_provider/microsoft_domain.mrs
    url: "https://github.com/MetaCubeX/meta-rules-dat/raw/refs/heads/meta/geo/geosite/microsoft.mrs"
  cn_ip:
    <<: *ipcidr
    path: ./rule_provider/cn_ip.mrs
    url: "https://github.com/MetaCubeX/meta-rules-dat/raw/refs/heads/meta/geo/geoip/cn.mrs"
  private_ip:
    <<: *ipcidr
    path: ./rule_provider/private_ip.mrs
    url: "https://github.com/MetaCubeX/meta-rules-dat/raw/refs/heads/meta/geo/geoip/private.mrs"
  cn_domain:
    <<: *domain
    path: ./rule_provider/cn_domain.mrs
    url: "https://github.com/MetaCubeX/meta-rules-dat/raw/refs/heads/meta/geo/geosite/cn.mrs"
  private_domain:
    <<: *domain
    path: ./rule_provider/private_domain.mrs
    url: "https://github.com/MetaCubeX/meta-rules-dat/raw/refs/heads/meta/geo/geosite/private.mrs"
  awavenue:
    <<: *domain
    path: ./rule_provider/awavenue.mrs
    url: "https://raw.githubusercontent.com/TG-Twilight/AWAvenue-Ads-Rule/main/Filters/AWAvenue-Ads-Rule-Clash.mrs"
  
rules:
  - DST-PORT,53,DNS_Hijack
  - DOMAIN-SUFFIX,omarea.com,å›½å¤–ä»£ç†
  - OR,((DST-PORT,5228),(DOMAIN-REGEX,^.*mtalk.google.com)),FCMæ¨é€
  - RULE-SET,Ai,Ai
  - OR,((RULE-SET,netflix_ip,no-resolve),(RULE-SET,netflix_domain)),å¥ˆé£è§†é¢‘
  - OR,((RULE-SET,telegram_ip,no-resolve),(RULE-SET,telegram_domain)),ç”µæŠ¥æ¶ˆæ¯
  - RULE-SET,github_domain,GITHUB
  - RULE-SET,youtube_domain,æ²¹ç®¡è§†é¢‘
  - OR,((RULE-SET,google_ip,no-resolve),(RULE-SET,google_domain)),è°·æ­ŒæœåŠ¡
  - RULE-SET,microsoft_domain,å¾®è½¯æœåŠ¡
  - RULE-SET,awavenue,å¹¿å‘Šæ‹¦æˆª
  - OR,((RULE-SET,cn_ip),(RULE-SET,cn_domain),(RULE-SET,private_ip),(RULE-SET,private_domain)),å›½å†…ç›´è¿
  - MATCH,æ¼ç½‘ä¹‹é±¼